--- buggy+++ fixed@@ -2439,7 +2439,7 @@   }
 
   // If we aren't dealing with a constant on the RHS, exit early.
-  auto *CI = dyn_cast<ConstantInt>(ICI.getOperand(1));
+  auto *CI = dyn_cast<Constant>(ICI.getOperand(1));
   if (!CI)
     return nullptr;
 
