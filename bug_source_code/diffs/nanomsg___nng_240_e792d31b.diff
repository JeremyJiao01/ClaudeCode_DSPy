--- buggy+++ fixed@@ -273,7 +273,7 @@ 		ch->ch_ptr -= len;
 	} else if ((ch->ch_len + len) <= ch->ch_cap) {
 		// We had enough capacity, just shuffle data down.
-		memmove(ch->ch_ptr + len, ch->ch_ptr, ch->ch_len);
+		memmove(ch->ch_buf + len, ch->ch_ptr, ch->ch_len);
 	} else if ((rv = nni_chunk_grow(ch, 0, len)) == 0) {
 		// We grew the chunk, so adjust.
 		ch->ch_ptr -= len;
